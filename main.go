package main

import (
	"fmt"
	"time"

	"github.com/golang-collections/collections/stack"
)

type Params struct {
	// OriginState, LastState   [][]int
	// RowCount, ColCount, I, J int

	I, J int
}

var count = 0

var cFromP = [2][][]int{
	{{0, 0, 0, 0}, {0, 0, 1, 1}, {0, 1, 0, 1}, {0, 1, 1, 0}, {0, 1, 1, 1}, {1, 0, 0, 1}, {1, 0, 1, 0}, {1, 0, 1, 1}, {1, 1, 0, 0}, {1, 1, 0, 1}, {1, 1, 1, 0}, {1, 1, 1, 1}},
	{{0, 0, 0, 1}, {0, 0, 1, 0}, {0, 1, 0, 0}, {1, 0, 0, 0}},
}

var c2x2FromP = map[string][][][]int{
	"0100": {{{0, 0, 0}, {0, 0, 1}, {0, 0, 1}}, {{0, 0, 0}, {0, 0, 1}, {1, 1, 0}}, {{0, 0, 0}, {0, 0, 1}, {1, 1, 1}}, {{0, 0, 0}, {1, 1, 0}, {0, 0, 1}}, {{0, 0, 0}, {1, 1, 0}, {0, 1, 0}}, {{0, 0, 0}, {1, 1, 0}, {0, 1, 1}}, {{0, 0, 0}, {1, 1, 0}, {1, 0, 1}}, {{0, 0, 0}, {1, 1, 0}, {1, 1, 0}}, {{0, 0, 0}, {1, 1, 0}, {1, 1, 1}}, {{0, 0, 1}, {0, 0, 0}, {0, 0, 0}}, {{0, 0, 1}, {0, 0, 0}, {1, 1, 1}}, {{0, 1, 0}, {1, 0, 0}, {0, 1, 1}}, {{0, 1, 0}, {1, 0, 0}, {1, 0, 0}}, {{0, 1, 0}, {1, 0, 0}, {1, 1, 1}}, {{1, 0, 0}, {0, 1, 0}, {0, 1, 0}}, {{1, 0, 0}, {0, 1, 0}, {0, 1, 1}}, {{1, 0, 0}, {0, 1, 0}, {1, 0, 1}}, {{1, 0, 0}, {0, 1, 0}, {1, 1, 0}}, {{1, 0, 0}, {0, 1, 0}, {1, 1, 1}}, {{1, 0, 0}, {1, 0, 1}, {0, 1, 0}}, {{1, 0, 0}, {1, 0, 1}, {0, 1, 1}}, {{1, 0, 0}, {1, 0, 1}, {1, 0, 1}}, {{1, 0, 0}, {1, 0, 1}, {1, 1, 0}}, {{1, 0, 0}, {1, 0, 1}, {1, 1, 1}}, {{1, 0, 0}, {1, 1, 0}, {0, 0, 1}}, {{1, 0, 0}, {1, 1, 0}, {0, 1, 0}}, {{1, 0, 0}, {1, 1, 0}, {0, 1, 1}}, {{1, 0, 0}, {1, 1, 0}, {1, 0, 1}}, {{1, 0, 0}, {1, 1, 0}, {1, 1, 0}}, {{1, 0, 0}, {1, 1, 0}, {1, 1, 1}}, {{1, 0, 1}, {1, 0, 0}, {0, 1, 1}}, {{1, 0, 1}, {1, 0, 0}, {1, 0, 0}}, {{1, 0, 1}, {1, 0, 0}, {1, 1, 1}}, {{1, 1, 0}, {0, 0, 0}, {0, 0, 0}}, {{1, 1, 0}, {0, 0, 0}, {1, 1, 1}}, {{1, 1, 0}, {1, 0, 0}, {0, 1, 1}}, {{1, 1, 0}, {1, 0, 0}, {1, 0, 0}}, {{1, 1, 0}, {1, 0, 0}, {1, 1, 1}}},
	"1111": {{{0, 0, 0}, {0, 1, 0}, {0, 0, 0}}, {{0, 0, 0}, {1, 0, 1}, {0, 0, 0}}, {{0, 0, 1}, {1, 0, 0}, {0, 0, 1}}, {{0, 1, 0}, {0, 0, 0}, {0, 1, 0}}, {{0, 1, 0}, {0, 0, 0}, {1, 0, 1}}, {{1, 0, 0}, {0, 0, 1}, {1, 0, 0}}, {{1, 0, 1}, {0, 0, 0}, {0, 1, 0}}, {{1, 0, 1}, {0, 0, 0}, {1, 0, 1}}},
	"1101": {{{0, 0, 0}, {0, 1, 0}, {1, 0, 0}}, {{0, 0, 0}, {1, 0, 1}, {1, 0, 0}}, {{0, 0, 1}, {1, 0, 0}, {0, 1, 0}}, {{0, 0, 1}, {1, 0, 0}, {1, 0, 1}}, {{0, 0, 1}, {1, 0, 0}, {1, 1, 0}}, {{0, 1, 0}, {0, 0, 0}, {0, 0, 1}}, {{0, 1, 0}, {0, 0, 0}, {1, 1, 0}}, {{1, 0, 0}, {0, 0, 1}, {0, 0, 0}}, {{1, 0, 1}, {0, 0, 0}, {0, 0, 1}}, {{1, 0, 1}, {0, 0, 0}, {1, 1, 0}}},
	"1010": {{{0, 0, 0}, {0, 1, 1}, {0, 0, 0}}, {{0, 0, 0}, {0, 1, 1}, {0, 0, 1}}, {{0, 0, 0}, {1, 0, 0}, {0, 0, 0}}, {{0, 0, 1}, {0, 1, 0}, {0, 0, 1}}, {{0, 0, 1}, {0, 1, 1}, {0, 0, 0}}, {{0, 0, 1}, {0, 1, 1}, {0, 0, 1}}, {{0, 0, 1}, {1, 0, 1}, {0, 0, 1}}, {{0, 1, 0}, {0, 0, 1}, {0, 1, 0}}, {{0, 1, 0}, {0, 0, 1}, {0, 1, 1}}, {{0, 1, 0}, {0, 0, 1}, {1, 0, 1}}, {{0, 1, 1}, {0, 0, 0}, {0, 1, 1}}, {{0, 1, 1}, {0, 0, 0}, {1, 0, 0}}, {{0, 1, 1}, {0, 0, 1}, {0, 1, 0}}, {{0, 1, 1}, {0, 0, 1}, {0, 1, 1}}, {{0, 1, 1}, {0, 0, 1}, {1, 0, 1}}, {{1, 0, 0}, {0, 0, 0}, {0, 1, 1}}, {{1, 0, 0}, {0, 0, 0}, {1, 0, 0}}, {{1, 0, 1}, {0, 0, 1}, {0, 1, 0}}, {{1, 0, 1}, {0, 0, 1}, {0, 1, 1}}, {{1, 0, 1}, {0, 0, 1}, {1, 0, 1}}},
	"1000": {{{0, 0, 0}, {0, 1, 1}, {0, 1, 0}}, {{0, 0, 0}, {0, 1, 1}, {0, 1, 1}}, {{0, 0, 0}, {0, 1, 1}, {1, 0, 0}}, {{0, 0, 0}, {0, 1, 1}, {1, 0, 1}}, {{0, 0, 0}, {0, 1, 1}, {1, 1, 0}}, {{0, 0, 0}, {0, 1, 1}, {1, 1, 1}}, {{0, 0, 0}, {1, 0, 0}, {0, 1, 1}}, {{0, 0, 0}, {1, 0, 0}, {1, 0, 0}}, {{0, 0, 0}, {1, 0, 0}, {1, 1, 1}}, {{0, 0, 1}, {0, 1, 0}, {0, 1, 0}}, {{0, 0, 1}, {0, 1, 0}, {0, 1, 1}}, {{0, 0, 1}, {0, 1, 0}, {1, 0, 1}}, {{0, 0, 1}, {0, 1, 0}, {1, 1, 0}}, {{0, 0, 1}, {0, 1, 0}, {1, 1, 1}}, {{0, 0, 1}, {0, 1, 1}, {0, 1, 0}}, {{0, 0, 1}, {0, 1, 1}, {0, 1, 1}}, {{0, 0, 1}, {0, 1, 1}, {1, 0, 0}}, {{0, 0, 1}, {0, 1, 1}, {1, 0, 1}}, {{0, 0, 1}, {0, 1, 1}, {1, 1, 0}}, {{0, 0, 1}, {0, 1, 1}, {1, 1, 1}}, {{0, 0, 1}, {1, 0, 1}, {0, 1, 0}}, {{0, 0, 1}, {1, 0, 1}, {0, 1, 1}}, {{0, 0, 1}, {1, 0, 1}, {1, 0, 1}}, {{0, 0, 1}, {1, 0, 1}, {1, 1, 0}}, {{0, 0, 1}, {1, 0, 1}, {1, 1, 1}}, {{0, 1, 0}, {0, 0, 1}, {0, 0, 1}}, {{0, 1, 0}, {0, 0, 1}, {1, 1, 0}}, {{0, 1, 0}, {0, 0, 1}, {1, 1, 1}}, {{0, 1, 1}, {0, 0, 0}, {0, 0, 0}}, {{0, 1, 1}, {0, 0, 0}, {1, 1, 1}}, {{0, 1, 1}, {0, 0, 1}, {0, 0, 1}}, {{0, 1, 1}, {0, 0, 1}, {1, 1, 0}}, {{0, 1, 1}, {0, 0, 1}, {1, 1, 1}}, {{1, 0, 0}, {0, 0, 0}, {0, 0, 0}}, {{1, 0, 0}, {0, 0, 0}, {1, 1, 1}}, {{1, 0, 1}, {0, 0, 1}, {0, 0, 1}}, {{1, 0, 1}, {0, 0, 1}, {1, 1, 0}}, {{1, 0, 1}, {0, 0, 1}, {1, 1, 1}}},
	"0001": {{{0, 0, 0}, {0, 0, 0}, {0, 0, 1}}, {{0, 0, 0}, {0, 0, 0}, {1, 1, 0}}, {{0, 0, 1}, {0, 0, 1}, {0, 0, 0}}, {{0, 0, 1}, {1, 1, 0}, {0, 0, 0}}, {{0, 0, 1}, {1, 1, 0}, {1, 0, 0}}, {{0, 1, 0}, {0, 1, 0}, {1, 0, 0}}, {{0, 1, 0}, {1, 0, 1}, {1, 0, 0}}, {{0, 1, 0}, {1, 1, 0}, {0, 0, 0}}, {{0, 1, 0}, {1, 1, 0}, {1, 0, 0}}, {{0, 1, 1}, {0, 1, 0}, {1, 0, 0}}, {{0, 1, 1}, {1, 0, 0}, {0, 1, 0}}, {{0, 1, 1}, {1, 0, 0}, {1, 0, 1}}, {{0, 1, 1}, {1, 0, 0}, {1, 1, 0}}, {{0, 1, 1}, {1, 0, 1}, {1, 0, 0}}, {{0, 1, 1}, {1, 1, 0}, {0, 0, 0}}, {{0, 1, 1}, {1, 1, 0}, {1, 0, 0}}, {{1, 0, 0}, {1, 0, 0}, {0, 1, 0}}, {{1, 0, 0}, {1, 0, 0}, {1, 0, 1}}, {{1, 0, 0}, {1, 0, 0}, {1, 1, 0}}, {{1, 0, 1}, {0, 1, 0}, {1, 0, 0}}, {{1, 0, 1}, {1, 0, 1}, {1, 0, 0}}, {{1, 0, 1}, {1, 1, 0}, {0, 0, 0}}, {{1, 0, 1}, {1, 1, 0}, {1, 0, 0}}, {{1, 1, 0}, {0, 0, 1}, {0, 0, 0}}, {{1, 1, 0}, {0, 1, 0}, {1, 0, 0}}, {{1, 1, 0}, {1, 0, 1}, {1, 0, 0}}, {{1, 1, 0}, {1, 1, 0}, {0, 0, 0}}, {{1, 1, 0}, {1, 1, 0}, {1, 0, 0}}, {{1, 1, 1}, {0, 0, 0}, {0, 0, 1}}, {{1, 1, 1}, {0, 0, 0}, {1, 1, 0}}, {{1, 1, 1}, {0, 0, 1}, {0, 0, 0}}, {{1, 1, 1}, {0, 1, 0}, {1, 0, 0}}, {{1, 1, 1}, {1, 0, 0}, {0, 1, 0}}, {{1, 1, 1}, {1, 0, 0}, {1, 0, 1}}, {{1, 1, 1}, {1, 0, 0}, {1, 1, 0}}, {{1, 1, 1}, {1, 0, 1}, {1, 0, 0}}, {{1, 1, 1}, {1, 1, 0}, {0, 0, 0}}, {{1, 1, 1}, {1, 1, 0}, {1, 0, 0}}},
	"0011": {{{0, 0, 0}, {0, 0, 0}, {0, 1, 0}}, {{0, 0, 0}, {0, 0, 0}, {1, 0, 1}}, {{0, 0, 1}, {0, 0, 1}, {1, 0, 0}}, {{0, 1, 0}, {0, 1, 0}, {0, 0, 0}}, {{0, 1, 0}, {1, 0, 1}, {0, 0, 0}}, {{0, 1, 1}, {0, 1, 0}, {0, 0, 0}}, {{0, 1, 1}, {1, 0, 0}, {0, 0, 1}}, {{0, 1, 1}, {1, 0, 1}, {0, 0, 0}}, {{1, 0, 0}, {1, 0, 0}, {0, 0, 1}}, {{1, 0, 1}, {0, 1, 0}, {0, 0, 0}}, {{1, 0, 1}, {1, 0, 1}, {0, 0, 0}}, {{1, 1, 0}, {0, 0, 1}, {1, 0, 0}}, {{1, 1, 0}, {0, 1, 0}, {0, 0, 0}}, {{1, 1, 0}, {1, 0, 1}, {0, 0, 0}}, {{1, 1, 1}, {0, 0, 0}, {0, 1, 0}}, {{1, 1, 1}, {0, 0, 0}, {1, 0, 1}}, {{1, 1, 1}, {0, 0, 1}, {1, 0, 0}}, {{1, 1, 1}, {0, 1, 0}, {0, 0, 0}}, {{1, 1, 1}, {1, 0, 0}, {0, 0, 1}}, {{1, 1, 1}, {1, 0, 1}, {0, 0, 0}}},
	"0101": {{{0, 0, 0}, {0, 0, 1}, {0, 0, 0}}, {{0, 0, 0}, {1, 1, 0}, {0, 0, 0}}, {{0, 0, 0}, {1, 1, 0}, {1, 0, 0}}, {{0, 0, 1}, {0, 0, 0}, {0, 0, 1}}, {{0, 0, 1}, {0, 0, 0}, {1, 1, 0}}, {{0, 1, 0}, {1, 0, 0}, {0, 1, 0}}, {{0, 1, 0}, {1, 0, 0}, {1, 0, 1}}, {{0, 1, 0}, {1, 0, 0}, {1, 1, 0}}, {{1, 0, 0}, {0, 1, 0}, {1, 0, 0}}, {{1, 0, 0}, {1, 0, 1}, {1, 0, 0}}, {{1, 0, 0}, {1, 1, 0}, {0, 0, 0}}, {{1, 0, 0}, {1, 1, 0}, {1, 0, 0}}, {{1, 0, 1}, {1, 0, 0}, {0, 1, 0}}, {{1, 0, 1}, {1, 0, 0}, {1, 0, 1}}, {{1, 0, 1}, {1, 0, 0}, {1, 1, 0}}, {{1, 1, 0}, {0, 0, 0}, {0, 0, 1}}, {{1, 1, 0}, {0, 0, 0}, {1, 1, 0}}, {{1, 1, 0}, {1, 0, 0}, {0, 1, 0}}, {{1, 1, 0}, {1, 0, 0}, {1, 0, 1}}, {{1, 1, 0}, {1, 0, 0}, {1, 1, 0}}},
	"1110": {{{0, 0, 0}, {0, 1, 0}, {0, 0, 1}}, {{0, 0, 0}, {1, 0, 1}, {0, 0, 1}}, {{0, 0, 1}, {1, 0, 0}, {0, 0, 0}}, {{0, 1, 0}, {0, 0, 0}, {0, 1, 1}}, {{0, 1, 0}, {0, 0, 0}, {1, 0, 0}}, {{1, 0, 0}, {0, 0, 1}, {0, 1, 0}}, {{1, 0, 0}, {0, 0, 1}, {0, 1, 1}}, {{1, 0, 0}, {0, 0, 1}, {1, 0, 1}}, {{1, 0, 1}, {0, 0, 0}, {0, 1, 1}}, {{1, 0, 1}, {0, 0, 0}, {1, 0, 0}}},
	"1100": {{{0, 0, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 0, 0}, {0, 1, 0}, {0, 1, 1}}, {{0, 0, 0}, {0, 1, 0}, {1, 0, 1}}, {{0, 0, 0}, {0, 1, 0}, {1, 1, 0}}, {{0, 0, 0}, {0, 1, 0}, {1, 1, 1}}, {{0, 0, 0}, {1, 0, 1}, {0, 1, 0}}, {{0, 0, 0}, {1, 0, 1}, {0, 1, 1}}, {{0, 0, 0}, {1, 0, 1}, {1, 0, 1}}, {{0, 0, 0}, {1, 0, 1}, {1, 1, 0}}, {{0, 0, 0}, {1, 0, 1}, {1, 1, 1}}, {{0, 0, 1}, {1, 0, 0}, {0, 1, 1}}, {{0, 0, 1}, {1, 0, 0}, {1, 0, 0}}, {{0, 0, 1}, {1, 0, 0}, {1, 1, 1}}, {{0, 1, 0}, {0, 0, 0}, {0, 0, 0}}, {{0, 1, 0}, {0, 0, 0}, {1, 1, 1}}, {{1, 0, 0}, {0, 0, 1}, {0, 0, 1}}, {{1, 0, 0}, {0, 0, 1}, {1, 1, 0}}, {{1, 0, 0}, {0, 0, 1}, {1, 1, 1}}, {{1, 0, 1}, {0, 0, 0}, {0, 0, 0}}, {{1, 0, 1}, {0, 0, 0}, {1, 1, 1}}},
	"1011": {{{0, 0, 0}, {1, 0, 0}, {0, 0, 1}}, {{0, 0, 1}, {0, 1, 0}, {0, 0, 0}}, {{0, 0, 1}, {1, 0, 1}, {0, 0, 0}}, {{0, 1, 0}, {0, 0, 1}, {1, 0, 0}}, {{0, 1, 1}, {0, 0, 0}, {0, 1, 0}}, {{0, 1, 1}, {0, 0, 0}, {1, 0, 1}}, {{0, 1, 1}, {0, 0, 1}, {1, 0, 0}}, {{1, 0, 0}, {0, 0, 0}, {0, 1, 0}}, {{1, 0, 0}, {0, 0, 0}, {1, 0, 1}}, {{1, 0, 1}, {0, 0, 1}, {1, 0, 0}}},
	"1001": {{{0, 0, 0}, {1, 0, 0}, {0, 1, 0}}, {{0, 0, 0}, {1, 0, 0}, {1, 0, 1}}, {{0, 0, 0}, {1, 0, 0}, {1, 1, 0}}, {{0, 0, 1}, {0, 1, 0}, {1, 0, 0}}, {{0, 0, 1}, {1, 0, 1}, {1, 0, 0}}, {{0, 1, 0}, {0, 0, 1}, {0, 0, 0}}, {{0, 1, 1}, {0, 0, 0}, {0, 0, 1}}, {{0, 1, 1}, {0, 0, 0}, {1, 1, 0}}, {{0, 1, 1}, {0, 0, 1}, {0, 0, 0}}, {{1, 0, 0}, {0, 0, 0}, {0, 0, 1}}, {{1, 0, 0}, {0, 0, 0}, {1, 1, 0}}, {{1, 0, 1}, {0, 0, 1}, {0, 0, 0}}},
	"0000": {{{0, 0, 0}, {0, 0, 0}, {0, 0, 0}}, {{0, 0, 0}, {0, 0, 0}, {1, 1, 1}}, {{0, 0, 0}, {1, 1, 1}, {0, 0, 0}}, {{0, 0, 0}, {1, 1, 1}, {0, 0, 1}}, {{0, 0, 0}, {1, 1, 1}, {0, 1, 0}}, {{0, 0, 0}, {1, 1, 1}, {0, 1, 1}}, {{0, 0, 0}, {1, 1, 1}, {1, 0, 0}}, {{0, 0, 0}, {1, 1, 1}, {1, 0, 1}}, {{0, 0, 0}, {1, 1, 1}, {1, 1, 0}}, {{0, 0, 0}, {1, 1, 1}, {1, 1, 1}}, {{0, 0, 1}, {0, 0, 1}, {0, 0, 1}}, {{0, 0, 1}, {0, 0, 1}, {1, 1, 0}}, {{0, 0, 1}, {0, 0, 1}, {1, 1, 1}}, {{0, 0, 1}, {1, 1, 0}, {0, 0, 1}}, {{0, 0, 1}, {1, 1, 0}, {0, 1, 0}}, {{0, 0, 1}, {1, 1, 0}, {0, 1, 1}}, {{0, 0, 1}, {1, 1, 0}, {1, 0, 1}}, {{0, 0, 1}, {1, 1, 0}, {1, 1, 0}}, {{0, 0, 1}, {1, 1, 0}, {1, 1, 1}}, {{0, 0, 1}, {1, 1, 1}, {0, 0, 0}}, {{0, 0, 1}, {1, 1, 1}, {0, 0, 1}}, {{0, 0, 1}, {1, 1, 1}, {0, 1, 0}}, {{0, 0, 1}, {1, 1, 1}, {0, 1, 1}}, {{0, 0, 1}, {1, 1, 1}, {1, 0, 0}}, {{0, 0, 1}, {1, 1, 1}, {1, 0, 1}}, {{0, 0, 1}, {1, 1, 1}, {1, 1, 0}}, {{0, 0, 1}, {1, 1, 1}, {1, 1, 1}}, {{0, 1, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 1, 0}, {0, 1, 0}, {0, 1, 1}}, {{0, 1, 0}, {0, 1, 0}, {1, 0, 1}}, {{0, 1, 0}, {0, 1, 0}, {1, 1, 0}}, {{0, 1, 0}, {0, 1, 0}, {1, 1, 1}}, {{0, 1, 0}, {0, 1, 1}, {0, 1, 0}}, {{0, 1, 0}, {0, 1, 1}, {0, 1, 1}}, {{0, 1, 0}, {0, 1, 1}, {1, 0, 0}}, {{0, 1, 0}, {0, 1, 1}, {1, 0, 1}}, {{0, 1, 0}, {0, 1, 1}, {1, 1, 0}}, {{0, 1, 0}, {0, 1, 1}, {1, 1, 1}}, {{0, 1, 0}, {1, 0, 1}, {0, 1, 0}}, {{0, 1, 0}, {1, 0, 1}, {0, 1, 1}}, {{0, 1, 0}, {1, 0, 1}, {1, 0, 1}}, {{0, 1, 0}, {1, 0, 1}, {1, 1, 0}}, {{0, 1, 0}, {1, 0, 1}, {1, 1, 1}}, {{0, 1, 0}, {1, 1, 0}, {0, 0, 1}}, {{0, 1, 0}, {1, 1, 0}, {0, 1, 0}}, {{0, 1, 0}, {1, 1, 0}, {0, 1, 1}}, {{0, 1, 0}, {1, 1, 0}, {1, 0, 1}}, {{0, 1, 0}, {1, 1, 0}, {1, 1, 0}}, {{0, 1, 0}, {1, 1, 0}, {1, 1, 1}}, {{0, 1, 0}, {1, 1, 1}, {0, 0, 0}}, {{0, 1, 0}, {1, 1, 1}, {0, 0, 1}}, {{0, 1, 0}, {1, 1, 1}, {0, 1, 0}}, {{0, 1, 0}, {1, 1, 1}, {0, 1, 1}}, {{0, 1, 0}, {1, 1, 1}, {1, 0, 0}}, {{0, 1, 0}, {1, 1, 1}, {1, 0, 1}}, {{0, 1, 0}, {1, 1, 1}, {1, 1, 0}}, {{0, 1, 0}, {1, 1, 1}, {1, 1, 1}}, {{0, 1, 1}, {0, 1, 0}, {0, 1, 0}}, {{0, 1, 1}, {0, 1, 0}, {0, 1, 1}}, {{0, 1, 1}, {0, 1, 0}, {1, 0, 1}}, {{0, 1, 1}, {0, 1, 0}, {1, 1, 0}}, {{0, 1, 1}, {0, 1, 0}, {1, 1, 1}}, {{0, 1, 1}, {0, 1, 1}, {0, 1, 0}}, {{0, 1, 1}, {0, 1, 1}, {0, 1, 1}}, {{0, 1, 1}, {0, 1, 1}, {1, 0, 0}}, {{0, 1, 1}, {0, 1, 1}, {1, 0, 1}}, {{0, 1, 1}, {0, 1, 1}, {1, 1, 0}}, {{0, 1, 1}, {0, 1, 1}, {1, 1, 1}}, {{0, 1, 1}, {1, 0, 0}, {0, 1, 1}}, {{0, 1, 1}, {1, 0, 0}, {1, 0, 0}}, {{0, 1, 1}, {1, 0, 0}, {1, 1, 1}}, {{0, 1, 1}, {1, 0, 1}, {0, 1, 0}}, {{0, 1, 1}, {1, 0, 1}, {0, 1, 1}}, {{0, 1, 1}, {1, 0, 1}, {1, 0, 1}}, {{0, 1, 1}, {1, 0, 1}, {1, 1, 0}}, {{0, 1, 1}, {1, 0, 1}, {1, 1, 1}}, {{0, 1, 1}, {1, 1, 0}, {0, 0, 1}}, {{0, 1, 1}, {1, 1, 0}, {0, 1, 0}}, {{0, 1, 1}, {1, 1, 0}, {0, 1, 1}}, {{0, 1, 1}, {1, 1, 0}, {1, 0, 1}}, {{0, 1, 1}, {1, 1, 0}, {1, 1, 0}}, {{0, 1, 1}, {1, 1, 0}, {1, 1, 1}}, {{0, 1, 1}, {1, 1, 1}, {0, 0, 0}}, {{0, 1, 1}, {1, 1, 1}, {0, 0, 1}}, {{0, 1, 1}, {1, 1, 1}, {0, 1, 0}}, {{0, 1, 1}, {1, 1, 1}, {0, 1, 1}}, {{0, 1, 1}, {1, 1, 1}, {1, 0, 0}}, {{0, 1, 1}, {1, 1, 1}, {1, 0, 1}}, {{0, 1, 1}, {1, 1, 1}, {1, 1, 0}}, {{0, 1, 1}, {1, 1, 1}, {1, 1, 1}}, {{1, 0, 0}, {0, 1, 1}, {0, 1, 0}}, {{1, 0, 0}, {0, 1, 1}, {0, 1, 1}}, {{1, 0, 0}, {0, 1, 1}, {1, 0, 0}}, {{1, 0, 0}, {0, 1, 1}, {1, 0, 1}}, {{1, 0, 0}, {0, 1, 1}, {1, 1, 0}}, {{1, 0, 0}, {0, 1, 1}, {1, 1, 1}}, {{1, 0, 0}, {1, 0, 0}, {0, 1, 1}}, {{1, 0, 0}, {1, 0, 0}, {1, 0, 0}}, {{1, 0, 0}, {1, 0, 0}, {1, 1, 1}}, {{1, 0, 0}, {1, 1, 1}, {0, 0, 0}}, {{1, 0, 0}, {1, 1, 1}, {0, 0, 1}}, {{1, 0, 0}, {1, 1, 1}, {0, 1, 0}}, {{1, 0, 0}, {1, 1, 1}, {0, 1, 1}}, {{1, 0, 0}, {1, 1, 1}, {1, 0, 0}}, {{1, 0, 0}, {1, 1, 1}, {1, 0, 1}}, {{1, 0, 0}, {1, 1, 1}, {1, 1, 0}}, {{1, 0, 0}, {1, 1, 1}, {1, 1, 1}}, {{1, 0, 1}, {0, 1, 0}, {0, 1, 0}}, {{1, 0, 1}, {0, 1, 0}, {0, 1, 1}}, {{1, 0, 1}, {0, 1, 0}, {1, 0, 1}}, {{1, 0, 1}, {0, 1, 0}, {1, 1, 0}}, {{1, 0, 1}, {0, 1, 0}, {1, 1, 1}}, {{1, 0, 1}, {0, 1, 1}, {0, 1, 0}}, {{1, 0, 1}, {0, 1, 1}, {0, 1, 1}}, {{1, 0, 1}, {0, 1, 1}, {1, 0, 0}}, {{1, 0, 1}, {0, 1, 1}, {1, 0, 1}}, {{1, 0, 1}, {0, 1, 1}, {1, 1, 0}}, {{1, 0, 1}, {0, 1, 1}, {1, 1, 1}}, {{1, 0, 1}, {1, 0, 1}, {0, 1, 0}}, {{1, 0, 1}, {1, 0, 1}, {0, 1, 1}}, {{1, 0, 1}, {1, 0, 1}, {1, 0, 1}}, {{1, 0, 1}, {1, 0, 1}, {1, 1, 0}}, {{1, 0, 1}, {1, 0, 1}, {1, 1, 1}}, {{1, 0, 1}, {1, 1, 0}, {0, 0, 1}}, {{1, 0, 1}, {1, 1, 0}, {0, 1, 0}}, {{1, 0, 1}, {1, 1, 0}, {0, 1, 1}}, {{1, 0, 1}, {1, 1, 0}, {1, 0, 1}}, {{1, 0, 1}, {1, 1, 0}, {1, 1, 0}}, {{1, 0, 1}, {1, 1, 0}, {1, 1, 1}}, {{1, 0, 1}, {1, 1, 1}, {0, 0, 0}}, {{1, 0, 1}, {1, 1, 1}, {0, 0, 1}}, {{1, 0, 1}, {1, 1, 1}, {0, 1, 0}}, {{1, 0, 1}, {1, 1, 1}, {0, 1, 1}}, {{1, 0, 1}, {1, 1, 1}, {1, 0, 0}}, {{1, 0, 1}, {1, 1, 1}, {1, 0, 1}}, {{1, 0, 1}, {1, 1, 1}, {1, 1, 0}}, {{1, 0, 1}, {1, 1, 1}, {1, 1, 1}}, {{1, 1, 0}, {0, 0, 1}, {0, 0, 1}}, {{1, 1, 0}, {0, 0, 1}, {1, 1, 0}}, {{1, 1, 0}, {0, 0, 1}, {1, 1, 1}}, {{1, 1, 0}, {0, 1, 0}, {0, 1, 0}}, {{1, 1, 0}, {0, 1, 0}, {0, 1, 1}}, {{1, 1, 0}, {0, 1, 0}, {1, 0, 1}}, {{1, 1, 0}, {0, 1, 0}, {1, 1, 0}}, {{1, 1, 0}, {0, 1, 0}, {1, 1, 1}}, {{1, 1, 0}, {0, 1, 1}, {0, 1, 0}}, {{1, 1, 0}, {0, 1, 1}, {0, 1, 1}}, {{1, 1, 0}, {0, 1, 1}, {1, 0, 0}}, {{1, 1, 0}, {0, 1, 1}, {1, 0, 1}}, {{1, 1, 0}, {0, 1, 1}, {1, 1, 0}}, {{1, 1, 0}, {0, 1, 1}, {1, 1, 1}}, {{1, 1, 0}, {1, 0, 1}, {0, 1, 0}}, {{1, 1, 0}, {1, 0, 1}, {0, 1, 1}}, {{1, 1, 0}, {1, 0, 1}, {1, 0, 1}}, {{1, 1, 0}, {1, 0, 1}, {1, 1, 0}}, {{1, 1, 0}, {1, 0, 1}, {1, 1, 1}}, {{1, 1, 0}, {1, 1, 0}, {0, 0, 1}}, {{1, 1, 0}, {1, 1, 0}, {0, 1, 0}}, {{1, 1, 0}, {1, 1, 0}, {0, 1, 1}}, {{1, 1, 0}, {1, 1, 0}, {1, 0, 1}}, {{1, 1, 0}, {1, 1, 0}, {1, 1, 0}}, {{1, 1, 0}, {1, 1, 0}, {1, 1, 1}}, {{1, 1, 0}, {1, 1, 1}, {0, 0, 0}}, {{1, 1, 0}, {1, 1, 1}, {0, 0, 1}}, {{1, 1, 0}, {1, 1, 1}, {0, 1, 0}}, {{1, 1, 0}, {1, 1, 1}, {0, 1, 1}}, {{1, 1, 0}, {1, 1, 1}, {1, 0, 0}}, {{1, 1, 0}, {1, 1, 1}, {1, 0, 1}}, {{1, 1, 0}, {1, 1, 1}, {1, 1, 0}}, {{1, 1, 0}, {1, 1, 1}, {1, 1, 1}}, {{1, 1, 1}, {0, 0, 0}, {0, 0, 0}}, {{1, 1, 1}, {0, 0, 0}, {1, 1, 1}}, {{1, 1, 1}, {0, 0, 1}, {0, 0, 1}}, {{1, 1, 1}, {0, 0, 1}, {1, 1, 0}}, {{1, 1, 1}, {0, 0, 1}, {1, 1, 1}}, {{1, 1, 1}, {0, 1, 0}, {0, 1, 0}}, {{1, 1, 1}, {0, 1, 0}, {0, 1, 1}}, {{1, 1, 1}, {0, 1, 0}, {1, 0, 1}}, {{1, 1, 1}, {0, 1, 0}, {1, 1, 0}}, {{1, 1, 1}, {0, 1, 0}, {1, 1, 1}}, {{1, 1, 1}, {0, 1, 1}, {0, 1, 0}}, {{1, 1, 1}, {0, 1, 1}, {0, 1, 1}}, {{1, 1, 1}, {0, 1, 1}, {1, 0, 0}}, {{1, 1, 1}, {0, 1, 1}, {1, 0, 1}}, {{1, 1, 1}, {0, 1, 1}, {1, 1, 0}}, {{1, 1, 1}, {0, 1, 1}, {1, 1, 1}}, {{1, 1, 1}, {1, 0, 0}, {0, 1, 1}}, {{1, 1, 1}, {1, 0, 0}, {1, 0, 0}}, {{1, 1, 1}, {1, 0, 0}, {1, 1, 1}}, {{1, 1, 1}, {1, 0, 1}, {0, 1, 0}}, {{1, 1, 1}, {1, 0, 1}, {0, 1, 1}}, {{1, 1, 1}, {1, 0, 1}, {1, 0, 1}}, {{1, 1, 1}, {1, 0, 1}, {1, 1, 0}}, {{1, 1, 1}, {1, 0, 1}, {1, 1, 1}}, {{1, 1, 1}, {1, 1, 0}, {0, 0, 1}}, {{1, 1, 1}, {1, 1, 0}, {0, 1, 0}}, {{1, 1, 1}, {1, 1, 0}, {0, 1, 1}}, {{1, 1, 1}, {1, 1, 0}, {1, 0, 1}}, {{1, 1, 1}, {1, 1, 0}, {1, 1, 0}}, {{1, 1, 1}, {1, 1, 0}, {1, 1, 1}}, {{1, 1, 1}, {1, 1, 1}, {0, 0, 0}}, {{1, 1, 1}, {1, 1, 1}, {0, 0, 1}}, {{1, 1, 1}, {1, 1, 1}, {0, 1, 0}}, {{1, 1, 1}, {1, 1, 1}, {0, 1, 1}}, {{1, 1, 1}, {1, 1, 1}, {1, 0, 0}}, {{1, 1, 1}, {1, 1, 1}, {1, 0, 1}}, {{1, 1, 1}, {1, 1, 1}, {1, 1, 0}}, {{1, 1, 1}, {1, 1, 1}, {1, 1, 1}}},
	"0010": {{{0, 0, 0}, {0, 0, 0}, {0, 1, 1}}, {{0, 0, 0}, {0, 0, 0}, {1, 0, 0}}, {{0, 0, 1}, {0, 0, 1}, {0, 1, 0}}, {{0, 0, 1}, {0, 0, 1}, {0, 1, 1}}, {{0, 0, 1}, {0, 0, 1}, {1, 0, 1}}, {{0, 1, 0}, {0, 1, 0}, {0, 0, 1}}, {{0, 1, 0}, {0, 1, 1}, {0, 0, 0}}, {{0, 1, 0}, {0, 1, 1}, {0, 0, 1}}, {{0, 1, 0}, {1, 0, 1}, {0, 0, 1}}, {{0, 1, 1}, {0, 1, 0}, {0, 0, 1}}, {{0, 1, 1}, {0, 1, 1}, {0, 0, 0}}, {{0, 1, 1}, {0, 1, 1}, {0, 0, 1}}, {{0, 1, 1}, {1, 0, 0}, {0, 0, 0}}, {{0, 1, 1}, {1, 0, 1}, {0, 0, 1}}, {{1, 0, 0}, {0, 1, 1}, {0, 0, 0}}, {{1, 0, 0}, {0, 1, 1}, {0, 0, 1}}, {{1, 0, 0}, {1, 0, 0}, {0, 0, 0}}, {{1, 0, 1}, {0, 1, 0}, {0, 0, 1}}, {{1, 0, 1}, {0, 1, 1}, {0, 0, 0}}, {{1, 0, 1}, {0, 1, 1}, {0, 0, 1}}, {{1, 0, 1}, {1, 0, 1}, {0, 0, 1}}, {{1, 1, 0}, {0, 0, 1}, {0, 1, 0}}, {{1, 1, 0}, {0, 0, 1}, {0, 1, 1}}, {{1, 1, 0}, {0, 0, 1}, {1, 0, 1}}, {{1, 1, 0}, {0, 1, 0}, {0, 0, 1}}, {{1, 1, 0}, {0, 1, 1}, {0, 0, 0}}, {{1, 1, 0}, {0, 1, 1}, {0, 0, 1}}, {{1, 1, 0}, {1, 0, 1}, {0, 0, 1}}, {{1, 1, 1}, {0, 0, 0}, {0, 1, 1}}, {{1, 1, 1}, {0, 0, 0}, {1, 0, 0}}, {{1, 1, 1}, {0, 0, 1}, {0, 1, 0}}, {{1, 1, 1}, {0, 0, 1}, {0, 1, 1}}, {{1, 1, 1}, {0, 0, 1}, {1, 0, 1}}, {{1, 1, 1}, {0, 1, 0}, {0, 0, 1}}, {{1, 1, 1}, {0, 1, 1}, {0, 0, 0}}, {{1, 1, 1}, {0, 1, 1}, {0, 0, 1}}, {{1, 1, 1}, {1, 0, 0}, {0, 0, 0}}, {{1, 1, 1}, {1, 0, 1}, {0, 0, 1}}},
	"0110": {{{0, 0, 0}, {0, 0, 1}, {0, 1, 0}}, {{0, 0, 0}, {0, 0, 1}, {0, 1, 1}}, {{0, 0, 0}, {0, 0, 1}, {1, 0, 1}}, {{0, 0, 1}, {0, 0, 0}, {0, 1, 1}}, {{0, 0, 1}, {0, 0, 0}, {1, 0, 0}}, {{0, 1, 0}, {1, 0, 0}, {0, 0, 0}}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, {{1, 0, 0}, {1, 0, 1}, {0, 0, 1}}, {{1, 0, 1}, {1, 0, 0}, {0, 0, 0}}, {{1, 1, 0}, {0, 0, 0}, {0, 1, 1}}, {{1, 1, 0}, {0, 0, 0}, {1, 0, 0}}, {{1, 1, 0}, {1, 0, 0}, {0, 0, 0}}},
	"0111": {{{0, 0, 0}, {0, 0, 1}, {1, 0, 0}}, {{0, 0, 1}, {0, 0, 0}, {0, 1, 0}}, {{0, 0, 1}, {0, 0, 0}, {1, 0, 1}}, {{0, 1, 0}, {1, 0, 0}, {0, 0, 1}}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 0}}, {{1, 0, 0}, {1, 0, 1}, {0, 0, 0}}, {{1, 0, 1}, {1, 0, 0}, {0, 0, 1}}, {{1, 1, 0}, {0, 0, 0}, {0, 1, 0}}, {{1, 1, 0}, {0, 0, 0}, {1, 0, 1}}, {{1, 1, 0}, {1, 0, 0}, {0, 0, 1}}},
}

func main() {
	var lastStates = [][][]int{
		{
			{1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0},
		},
	}
	for _, lastState := range lastStates {
		start := time.Now()
		count = 0
		var rowCount = len(lastState)
		var colCount = len(lastState[0])
		var originState = genOriginState(rowCount, colCount)
		exec(originState, lastState, rowCount, colCount, 0, 0)
		coolExec(lastState, rowCount, colCount)
		fmt.Printf("result: %d - process in %v\n", count, time.Since(start))
	}
}

// cộng 1 vào 0 tức là số case chuỗi gốc trừ chuỗi công 1 với đuối thay bằng 1
// cộng số case chuỗi gốc với đuối thay bằng 1

// cộng 1 vào 1 tức là nhân đôi case trước của chuỗi gốc
// trừ 2 lần case trước nữa

// cộng 0 vào 1 tức là thê đc 4 case ở đuôi (x4)
// trừ số case nếu cộng 1

// cộng 0 vào 0 tức là têm đc 4 case ở đuôi (x4)
// trừ đi số case nếu cộng 1

var res []int

func coolExec(lastState [][]int, rowCount, colCount int) {

	cur := 38
	prev := 12
	cur1tail := 10
	if lastState[0][0] == 0 {
		if lastState[0][1] == 0 { // 00
			cur = 38
			prev = 12
			cur1tail = 10 // 01
		} else { // 01
			cur = 10
			prev = 12
			cur1tail = 10 // 01
		}
	} else {
		if lastState[0][1] == 0 { // 10
			cur = 10
			prev = 4
			cur1tail = 6
		} else { // 11
			cur = 6
			prev = 4
			cur1tail = 6
		}
	}
	res = append(res, 4, prev, cur)
	for i := 2; i < colCount; i++ {
		fmt.Printf("%v cur %v - %v - %v\n", lastState[0][:i+1], cur, prev, cur1tail)
		tmp := cur
		if lastState[0][i-1] == 1 { //1 + 1
			if lastState[0][i-2] == 1 { // 11+1
				cur1tail = 2 * prev
			} else { // 01+1
				cur1tail = 2*res[i-1] - 2*res[i-2]
			}
		} else { // 0 + 1
			cur1tailPlus1 := 0          // cur1tail + "1"
			if lastState[0][i-2] == 1 { // 11+1
				cur1tailPlus1 = 2 * prev
			} else { // 01+1
				fmt.Printf("res = %v\n", res)
				cur1tailPlus1 = 2*res[i-1] - 2*res[i-2]
			}
			fmt.Printf("cur1tail = %v - %v + %v\n", cur, cur1tailPlus1, cur1tail)
			cur1tail = cur - cur1tailPlus1 + cur1tail
		}
		if lastState[0][i] == 1 {
			cur = cur1tail
		} else {
			if lastState[0][i-1] == 1 { // 1+0
				if lastState[0][i-2] == 1 {
					cur = cur*4 - 2*prev
				} else {
					cur = cur*4 - (2*res[i-1] - 2*res[i-2])
				}
			} else { //0+0
				fmt.Printf("cur = %v*4 - %v\n", cur, cur1tail)
				cur = cur*4 - cur1tail
			}
		}
		prev = tmp
		res = append(res, cur)
	}
	fmt.Printf("cur %v -%v\n", cur, res)
}

func exec(originState, lastState [][]int, rowCount, colCount, i, j int) {
	for _, c := range cFromP[lastState[i][j]] {
		if check(originState, i, j, c[0], c[1], c[2], c[3]) {
			originState[i][j] = c[0]
			originState[i][j+1] = c[1]
			originState[i+1][j] = c[2]
			originState[i+1][j+1] = c[3]
			if j < colCount-1 {
				exec(originState, lastState, rowCount, colCount, i, j+1)
			} else if i < rowCount-1 {
				exec(originState, lastState, rowCount, colCount, i+1, 0)
			} else {
				// for _, v := range originState {
				// 	fmt.Printf("%v %v %+v\n", i, j, v)
				// }
				count++
			}
		}
	}
}

// func exec2x2(originState, lastState [][]int, rowCount, colCount, i, j int) {
// 	key := fmt.Sprintf("%d%d%d%d", lastState[i][j], lastState[i][j+1], lastState[i+1][j], lastState[i+1][j+1])
// 	for _, c := range c2x2FromP[key] {
// 		if check2x2(originState, i, j, c) {
// 			originState[i][j] = c[0]
// 			originState[i][j+1] = c[1]
// 			originState[i+1][j] = c[2]
// 			originState[i+1][j+1] = c[3]
// 			if j < colCount-1 {
// 				exec(originState, lastState, rowCount, colCount, i, j+1)
// 			} else if i < rowCount-1 {
// 				exec(originState, lastState, rowCount, colCount, i+1, 0)
// 			} else {
// 				// for _, v := range originState {
// 				// 	fmt.Printf("%v %v %+v\n", i, j, v)
// 				// }
// 				count++
// 			}
// 		}
// 	}
// }

func execSt(originState, lastState [][]int, rowCount, colCount, y, x int) {
	// fmt.Printf("%v %v\n", i, j)
	// for _, v := range originState {
	// 	fmt.Printf("%v %v %+v\n", i, j, v)
	// }
	st := stack.New()
	st.Push(Params{I: y, J: x})
	for st.Len() > 0 {
		params := st.Pop().(Params)
		fmt.Printf("p%+v\n", params)
		// originState, lastState, rowCount, colCount, i, j := params.OriginState, params.LastState, params.RowCount, params.ColCount, params.I, params.J
		i, j := params.I, params.J
		for _, c := range cFromP[lastState[i][j]] {
			if check(originState, i, j, c[0], c[1], c[2], c[3]) {
				originState[i][j] = c[0]
				originState[i][j+1] = c[1]
				originState[i+1][j] = c[2]
				originState[i+1][j+1] = c[3]
				if j < colCount-1 {
					st.Push(Params{I: i, J: j + 1})
				} else if i < rowCount-1 {
					st.Push(Params{I: i + 1, J: 0})
				} else {
					for _, v := range originState {
						fmt.Printf("%+v\n", v)
					}
					fmt.Println()
					count++
				}
			}
		}
	}

}

func check2x2(originState [][]int, i, j int, p [][]int) bool {

	return false
}

func check(originState [][]int, i, j, p00, p01, p10, p11 int) bool {
	if i == 0 && j == 0 {
		return true
	}

	if i == 0 {
		if originState[i][j] == p00 && originState[i+1][j] == p10 {
			return true
		}
		return false
	}

	if j == 0 {
		if originState[i][j] == p00 && originState[i][j+1] == p01 {
			return true
		}
		return false
	}

	if originState[i][j] == p00 && originState[i+1][j] == p10 && originState[i][j+1] == p01 {
		return true
	}

	return false
}

func genOriginState(rowCount, colCount int) [][]int {
	originState := [][]int{}
	for i := 0; i <= rowCount; i++ {
		arr := []int{}
		for j := 0; j <= colCount; j++ {
			arr = append(arr, 0)
		}
		originState = append(originState, arr)
	}
	return originState
}
